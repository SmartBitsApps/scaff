<h1>Přehled všech pracovních nabídek</h1>

<table class="table table-sm">
  <thead>
    <tr>
      <th>Název</th>
      <th>Popis</th>
      <th>Začátek</th>
      <th>Konec</th>
      <th>Manažer</th>
      <th>Adresa</th>
      <th>Pozice</th>
      <th colspan="3"></th>
    </tr>
  </thead>
  <tbody>
    <% @events.each do |event| %>
      <tr>
        <td><%= event.title %></td>
        <td><%= event.description %></td>
        <td><%= event.start_date %></td>
        <td><%= event.end_date %></td>
        <!-- TODO: check before delete user if he is event manager + add link_to for message and phone contact -->
        <td><%= User.find_by(id: event.manager).full_name unless event.manager %></td>
        <td><%= link_to event.event_addresses.count, event_path(event) %></td>
        <td><%= event_brigade_sum(event) %></td>
        <td><%= link_to 'Detail', event %></td>
        <% if current_user.role == "admin" || current_user.role == "manager" %>
          <td><%= link_to 'Upravit', edit_event_path(event) %></td>
          <td><%= link_to 'Smazat', event, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <% end %>
      </tr>
    <% end %>
    
  </tbody>
</table>

<br>

<%= link_to 'Nová nabídka', new_event_path, class: "btn btn-primary" %>